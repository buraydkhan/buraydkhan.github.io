<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Burayd Khan| GitHub IO</title>
    <script type="module" src="https://unpkg.com/chessboard-element?module"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>
    <style>
        :root {
            --bg: #161512;
            --accent: #95bb4a;
            --timer-bg: #262421;
        }

        body {
            background-color: var(--bg);
            color: white;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
        }

        /* Container to keep everything centered and aligned */
        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 90vw;
            max-width: 550px;
        }

        /* Timers positioned above the board */
        .timer-row {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-bottom: 10px;
        }

        .timer {
            background: var(--timer-bg);
            padding: 10px 20px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 1.5rem;
            border: 2px solid transparent;
            min-width: 80px;
            text-align: center;
        }

        .timer.active {
            border-color: var(--accent);
            color: var(--accent);
        }

        /* Board Styling */
        chess-board {
            width: 100%;
            box-shadow: 0 15px 50px rgba(0,0,0,0.6);
            border: 4px solid #222;
        }

        chess-board::part(highlight) { background-color: rgba(255, 255, 0, 0.3); }
        .hint-sq { background-color: rgba(0, 0, 0, 0.15); border-radius: 50%; width: 25%; height: 25%; margin: 37.5%; }

        /* Controls below the board */
        .controls {
            width: 100%;
            margin-top: 20px;
            text-align: center;
        }

        .status-text {
            margin-bottom: 15px;
            font-weight: 300;
            letter-spacing: 1px;
            color: #aaa;
        }

        .btn {
            background: #333;
            color: #eee;
            border: none;
            padding: 10px 25px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.2s;
        }

        .btn:hover { background: #444; }
    </style>
</head>
<body>

    <div class="game-container">
        <div class="timer-row">
            <div id="timer-black" class="timer">10:00</div>
            <div id="timer-white" class="timer active">10:00</div>
        </div>

        <chess-board id="board" position="start" draggable-pieces></chess-board>

        <div class="controls">
            <div id="status" class="status-text">YOUR TURN (WHITE)</div>
            <button class="btn" onclick="location.reload()">RESTART GAME</button>
        </div>
    </div>

    <script>
        const board = document.getElementById('board');
        const game = new Chess();
        const statusEl = document.getElementById('status');
        
        let whiteTime = 600, blackTime = 600;
        let timerInterval = null;

        function formatTime(s) {
            const mins = Math.floor(s / 60);
            const secs = s % 60;
            return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
        }

        function startTimer() {
            if (timerInterval) return;
            timerInterval = setInterval(() => {
                if (game.turn() === 'w') {
                    whiteTime--;
                    document.getElementById('timer-white').innerText = formatTime(whiteTime);
                    document.getElementById('timer-white').classList.add('active');
                    document.getElementById('timer-black').classList.remove('active');
                } else {
                    blackTime--;
                    document.getElementById('timer-black').innerText = formatTime(blackTime);
                    document.getElementById('timer-black').classList.add('active');
                    document.getElementById('timer-white').classList.remove('active');
                }
                if (whiteTime <= 0 || blackTime <= 0) endGame("TIME EXPIRED");
            }, 1000);
        }

        // --- Move Hints ---
        board.addEventListener('mouseover-square', (e) => {
            const moves = game.moves({ square: e.detail.square, verbose: true });
            moves.forEach(m => {
                const el = board.shadowRoot.querySelector(`[part~="square-${m.to}"]`);
                if (el && !el.querySelector('.hint-sq')) {
                    const dot = document.createElement('div');
                    dot.className = "hint-sq";
                    el.appendChild(dot);
                }
            });
        });

        board.addEventListener('mouseout-square', () => {
            board.shadowRoot.querySelectorAll('.hint-sq').forEach(el => el.remove());
        });

        // --- Core Logic ---
        board.addEventListener('drop', (e) => {
            const move = game.move({ from: e.detail.source, to: e.detail.target, promotion: 'q' });
            if (move === null) {
                e.detail.setAction('snapback');
                return;
            }
            startTimer();
            updateStatus();
            window.setTimeout(makeBotMove, 400);
        });

        function updateStatus() {
            if (game.in_checkmate()) endGame("CHECKMATE");
            else if (game.in_draw()) endGame("DRAW");
            else statusEl.innerText = game.turn() === 'w' ? "YOUR TURN" : "BOT IS THINKING...";
        }

        function endGame(msg) {
            clearInterval(timerInterval);
            statusEl.innerText = msg;
            board.setAttribute('draggable-pieces', 'false');
        }

        // Simple Bot
        function makeBotMove() {
            if (game.game_over()) return;
            const moves = game.moves();
            
            // Basic Material Evaluation
            let bestMove = moves[0];
            let bestValue = 9999;

            moves.forEach(m => {
                game.move(m);
                let score = 0;
                game.board().forEach(row => {
                    row.forEach(p => {
                        if (p) {
                            const val = {p:1, n:3, b:3, r:5, q:9, k:100}[p.type];
                            score += (p.color === 'w' ? val : -val);
                        }
                    });
                });
                if (score < bestValue) { bestValue = score; bestMove = m; }
                game.undo();
            });

            game.move(bestMove);
            board.setPosition(game.fen());
            updateStatus();
        }
    </script>
</body>
</html>
